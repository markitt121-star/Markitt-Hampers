<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Markitt Hamper Service</title>
<style>
:root{--primary:#5bcf7a;--primary-dark:#3fb963;--glass-bg:rgba(255,255,255,0.25);--shadow:rgba(0,0,0,0.1);--text-dark:#222;--hover-shadow:rgba(0,0,0,0.3);--border-radius:12px;}
body{margin:0;font-family:'Segoe UI',sans-serif;background:#f3faf4;color:var(--text-dark);}
.header{display:flex;justify-content:space-between;align-items:center;padding:20px 30px;background:var(--glass-bg);backdrop-filter:blur(15px);border-radius:var(--border-radius);margin:20px;flex-wrap:wrap;}
.header .brand{font-size:28px;font-weight:700;color:var(--primary);}
.total-orders{font-weight:600;background:rgba(91,207,122,0.15);padding:10px 20px;border-radius:25px;color:var(--primary-dark);font-size:16px;text-align:center;}
.container{max-width:1200px;margin:30px auto;padding:0 20px;}
.hampers-grid{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:20px;}
.hamper-card{background:var(--glass-bg);backdrop-filter:blur(15px);border-radius:var(--border-radius);padding:20px;box-shadow:0 8px 30px var(--shadow);position:relative;overflow:hidden;transition:0.4s;}
.hamper-card:hover{transform:translateY(-10px);box-shadow:0 15px 40px var(--hover-shadow);}
.hamper-card h4{margin-top:0;color:var(--primary-dark);font-size:20px;}
.quantity-price{display:flex;justify-content:space-between;align-items:center;margin-top:10px;flex-wrap:wrap;gap:5px;}
.hamper-quantity,.hamper-variety{padding:5px;border-radius:6px;border:1px solid #ccc;}
.price-display{font-weight:600;color:var(--primary-dark);}
.total-section{margin-top:20px;text-align:right;font-size:18px;font-weight:700;color:var(--primary-dark);}
form{margin-top:30px;background:var(--glass-bg);backdrop-filter:blur(15px);border-radius:var(--border-radius);padding:25px;box-shadow:0 8px 30px var(--shadow);}
form input,form select,form textarea{width:100%;padding:12px;margin-bottom:15px;border-radius:10px;border:none;background:rgba(255,255,255,0.7);font-size:14px;}
form button{width:100%;padding:14px;border:none;border-radius:10px;font-weight:600;background:var(--primary);color:white;cursor:pointer;margin-bottom:10px;font-size:16px;}
form button:hover{background:var(--primary-dark);}
.popup{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%) scale(0);background:var(--primary);color:white;padding:25px 35px;border-radius:15px;font-size:16px;font-weight:600;box-shadow:0 15px 50px rgba(0,0,0,0.3);z-index:999;opacity:0;transition:0.3s;}
.popup.show{transform:translate(-50%,-50%) scale(1);opacity:1;}
.order-summary{background:rgba(255,255,255,0.6);backdrop-filter:blur(12px);padding:15px;border-radius:15px;margin-top:15px;font-size:14px;white-space:pre-line;}
</style>
</head>
<body>
<div class="header">
  <div>
    <div class="brand">Markitt Hamper Service</div>
    <div class="tagline">Serving Across Pakistan â€“ Orders Worldwide</div>
  </div>
  <div class="total-orders">ðŸ’š Orders Placed: <span id="ordersCounter">0</span></div>
</div>

<div class="container">
<div class="currency-select">
<label>Select Currency:</label>
<select id="currency">
<option value="PKR" selected>PKR (â‚¨)</option>
<option value="USD">USD ($)</option>
<option value="GBP">GBP (Â£)</option>
<option value="EUR">EUR (â‚¬)</option>
<option value="AED">AED (Ø¯.Ø¥)</option>
<option value="SAR">SAR (ï·¼)</option>
</select>
</div>

<div class="hampers-grid" id="hampersGrid"></div>
<div class="total-section">Total Price: <span id="totalPrice">â‚¨0.00</span></div>
<div class="order-summary" id="liveOrderSummary">Your order summary will appear here...</div>

<form id="orderForm">
<input name="sender" placeholder="Sender Name / Country" required>
<input name="receiver" placeholder="Receiver Name / City in Pakistan" required>
<input name="phone" placeholder="Receiver Phone Number" required>
<input name="email" placeholder="Email (Optional)">
<textarea name="address" placeholder="Delivery Address" required></textarea>
<input type="file" id="paymentScreenshot" accept="image/*">
<button type="submit">ðŸ’¬ Order via WhatsApp & Google Sheet</button>
</form>
<div id="popup" class="popup">âœ… Your order has been initiated!</div>
</div>

<script>
// --- Data ---
const hampersData=[
{ name:"Hamper 1", varieties:[{type:"Basic",price:3499,items:["Flour 5kg","Rice 1kg","Sugar 1kg","Cooking Oil"]},{type:"Deluxe",price:3999,items:["Flour 7kg","Rice 2kg","Sugar 2kg","Cooking Oil","Tea 0.5kg"]}]},
{ name:"Hamper 2", varieties:[{type:"Standard",price:5499,items:["Flour 10kg","Rice 5kg","Sugar 2kg","Cooking Oil 2L","Tea 1kg"]},{type:"Premium",price:5999,items:["Flour 12kg","Rice 6kg","Sugar 3kg","Cooking Oil 3L","Tea 1kg","Biscuits"]}]},
{ name:"Hamper 3", varieties:[{type:"Classic",price:6999,items:["Flour 15kg","Rice 10kg","Sugar 5kg","Cooking Oil 5L","Tea 2kg","Biscuits & Snacks","Special Gift Item"]},{type:"Luxury",price:7999,items:["Flour 20kg","Rice 15kg","Sugar 7kg","Cooking Oil 7L","Tea 3kg","Biscuits & Snacks","Special Gift Item","Chocolate Box"]}]}
];
const hampersGrid=document.getElementById('hampersGrid');
const symbols={PKR:"â‚¨",USD:"$",GBP:"Â£",EUR:"â‚¬",AED:"Ø¯.Ø¥",SAR:"ï·¼"};
const rates={PKR:1,USD:0.00357,GBP:0.0028,EUR:0.0032,AED:0.013,SAR:0.0134};

hampersData.forEach((h,i)=>{
  const card=document.createElement('div'); card.className='hamper-card'; card.dataset.name=h.name;
  card.innerHTML=`<h4>${h.name}</h4>
  <label>Choose Variety:</label>
  <select class="hamper-variety">${h.varieties.map((v,idx)=>`<option value="${idx}">${v.type}</option>`).join('')}</select>
  <ul class="hamper-items"></ul>
  <div class="quantity-price">Quantity: <input type="number" class="hamper-quantity" value="0" min="0">
  <div class="price-display">â‚¨0.00</div></div>`;
  hampersGrid.appendChild(card);
});

const hamperCards=document.querySelectorAll('.hamper-card');
const totalPriceEl=document.getElementById('totalPrice');
const liveSummary=document.getElementById('liveOrderSummary');

function updatePricesAndSummary(){
  const currency=document.getElementById('currency').value;
  let total=0; let summaryText="Your Order Summary:\n";
  hamperCards.forEach((card,i)=>{
    const qty=Number(card.querySelector('.hamper-quantity').value);
    const varietyIndex=card.querySelector('.hamper-variety').value;
    const selectedVariety=hampersData[i].varieties[varietyIndex];
    card.querySelector('.hamper-items').innerHTML=selectedVariety.items.map(it=>`<li>${it}</li>`).join('');
    if(qty>0){
      const totalPriceForCard = selectedVariety.price * qty;
      const convertedPrice = totalPriceForCard * rates[currency];
      card.querySelector('.price-display').textContent=`${symbols[currency]}${convertedPrice.toFixed(2)}`;
      total+=convertedPrice;
      summaryText+=`${card.dataset.name} (${selectedVariety.type}) x ${qty} = ${symbols[currency]}${convertedPrice.toFixed(2)}\nItems: ${selectedVariety.items.join(", ")}\n\n`;
    } else card.querySelector('.price-display').textContent=`${symbols[currency]}0.00`;
  });
  totalPriceEl.textContent=`${symbols[currency]}${total.toFixed(2)}`;
  summaryText+=`Total Price: ${symbols[currency]}${total.toFixed(2)}`;
  liveSummary.textContent=summaryText;
}

document.getElementById('currency').addEventListener('change',updatePricesAndSummary);
hamperCards.forEach(card=>{
  card.querySelector('.hamper-quantity').addEventListener('input',updatePricesAndSummary);
  card.querySelector('.hamper-variety').addEventListener('change',updatePricesAndSummary);
});
updatePricesAndSummary();

// --- Form Submission ---
const form=document.getElementById('orderForm');
form.addEventListener('submit', async function(e){
  e.preventDefault();
  updatePricesAndSummary();

  let hampersOrder=[];
  hamperCards.forEach((card,i)=>{
    const qty=Number(card.querySelector('.hamper-quantity').value);
    const varietyIndex=card.querySelector('.hamper-variety').value;
    if(qty>0){
      const selectedVariety=hampersData[i].varieties[varietyIndex];
      hampersOrder.push({name:card.dataset.name,variety:selectedVariety.type,quantity:qty,items:selectedVariety.items,price:selectedVariety.price});
    }
  });

  if(hampersOrder.length===0){ alert("Select at least one hamper!"); return; }

  const currency=document.getElementById('currency').value;
  let orderSummary=""; let totalPrice=0;
  hampersOrder.forEach(h=>{
    const total=h.price*h.quantity*rates[currency];
    totalPrice+=total;
    orderSummary+=`${h.name} (${h.variety}) x ${h.quantity} = ${symbols[currency]}${total.toFixed(2)}\nItems: ${h.items.join(", ")}\n\n`;
  });
  orderSummary+=`Total: ${symbols[currency]}${totalPrice.toFixed(2)}`;

  // Payment Screenshot
  const paymentFile = form.paymentScreenshot.files[0];
  let paymentBase64="", paymentType="";
  if(paymentFile){
    const reader = new FileReader();
    reader.onload = async function(){
      paymentBase64 = reader.result.split(",")[1];
      paymentType = paymentFile.type;
      await sendToGoogleSheet(paymentBase64,paymentType);
    }
    reader.readAsDataURL(paymentFile);
  } else await sendToGoogleSheet();

  async function sendToGoogleSheet(base64="", type=""){
    const data={
      sender: form.sender.value,
      receiver: form.receiver.value,
      phone: form.phone.value,
      email: form.email.value,
      address: form.address.value,
      orderSummary: orderSummary,
      totalPrice: `${symbols[currency]}${totalPrice.toFixed(2)}`,
      paymentScreenshotBase64: base64,
      paymentScreenshotType: type
    };
    // --- Replace with your Google Apps Script Web App URL ---
    const resp=await fetch("YOUR_WEB_APP_URL_HERE", {method:"POST",body:JSON.stringify(data),headers:{"Content-Type":"application/json"}});
    const result=await resp.json();
    console.log(result);

    // WhatsApp
    let waMsg=`Hello! I would like to place this order:\n\n${orderSummary}`;
    if(result.paymentLink) waMsg+="\nPayment Screenshot: "+result.paymentLink;
    window.open(`https://wa.me/923422088395?text=${encodeURIComponent(waMsg)}`,"_blank");

    // Popup
    document.getElementById('popup').classList.add('show');
    setTimeout(()=>document.getElementById('popup').classList.remove('show'),3000);

    // Increment Orders Placed
    const counter=document.getElementById('ordersCounter');
    counter.textContent=Number(counter.textContent)+1;
  }
});
</script>
</body>
</html>
